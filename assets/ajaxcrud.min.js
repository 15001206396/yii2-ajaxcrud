/*!
 * Ajax Crud 
 * =================================
 * Use for johnitvn/yii2-ajaxcrud extension
 */!function(t){function e(){t(h).modal("toggle")}function a(a){var o=t.extend({type:"default",title:"",closeButton:!0,loading:!0,url:"create",method:"GET",positiveButton:null,negativeButton:null,onPositiveClick:null,onNegativeClick:null},a);t(h).find(".modal-dialog").addClass("modal-"+o.type),o.loading&&(t(h).find(".modal-header .modal-title").remove(),t(h).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(h).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>')),o.closeButton||t(h).find(".modal-title button.close").remove(),t(h).modal(),t.ajax({url:o.url,method:o.method,success:function(a){t(h).find(".modal-header .modal-title").remove(),t(h).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">'+o.title+"</h4></div>"),t(h).find(".modal-body").html(a.data),(null!=o.positiveButton||null!=o.negativeButton)&&(modalFooter=document.createElement("div"),modalFooter.setAttribute("class","modal-footer"),t(h).find(".modal-content").append(modalFooter),null!=o.positiveButton&&(positiveButtonElm=document.createElement("button"),positiveButtonElm.setAttribute("class","btn btn-primary"),positiveButtonElm.innerHTML=o.positiveButton,t(modalFooter).append(positiveButtonElm),null!=o.onPositiveClick&&t(positiveButtonElm).click(function(t){o.onPositiveClick(t)})),null!=o.negativeButton&&(negativeButtonElm=document.createElement("button"),negativeButtonElm.setAttribute("class","btn btn-default pull-left"),negativeButtonElm.innerHTML=o.negativeButton,t(modalFooter).append(negativeButtonElm),t(negativeButtonElm).click(function(t){e(),null!=o.onNegativeClick&&o.onNegativeClick(t)}))),t(this).find("form").submit(function(t){t.preventDefault()})}})}function o(){$modalDialog=t(h).find(".modal-dialog"),$modalDialog.attr("class",""),$modalDialog.addClass("modal-dialog"),t(h).find(".modal-footer").remove(),t(h).find(".modal-body").html(""),t(h).find(".modal-title").html("")}function i(){t.pjax.reload({container:g})}function l(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function d(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function n(e){e.preventDefault(),a({url:t(b).attr("href"),title:t(b).hasAttr("data-modal-title")?t(b).attr("data-modal-title"):"Create new",positiveButton:t(b).hasAttr("data-modal-positive")?t(b).attr("data-modal-positive"):"Save",negativeButton:t(b).hasAttr("data-modal-negative")?t(b).attr("data-modal-negative"):"Cancel",onPositiveClick:f})}function s(a){return a.preventDefault(),confirm(t(this).attr("data-confirm-message"))&&(t(h).find(".modal-header .modal-title").remove(),t(h).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(h).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>'),t(h).modal(),t.ajax({url:t(this).attr("href"),method:t(this).attr("data-method"),success:function(){i(),e()}})),!1}function r(e){e.preventDefault(),a({url:t(this).attr("href"),title:t(this).hasAttr("data-modal-title")?t(this).attr("data-modal-title"):"View",negativeButton:t(this).hasAttr("data-modal-negative")?t(this).attr("data-modal-negative"):"Close"})}function c(e){e.preventDefault(),a({url:t(this).attr("href"),title:t(this).hasAttr("data-modal-title")?t(this).attr("data-modal-title"):"Update",positiveButton:t(this).hasAttr("data-modal-positive")?t(this).attr("data-modal-positive"):"Save",negativeButton:t(this).hasAttr("data-modal-negative")?t(this).attr("data-modal-negative"):"Cancel",onPositiveClick:v})}function m(a){a.preventDefault();var o=[];return t('input:checkbox[name="selection[]"]').each(function(){this.checked&&o.push(t(this).val())}),0==o.length?!1:(confirm(t(y).attr("data-confirm-message"))&&(t(h).find(".modal-header .modal-title").remove(),t(h).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(h).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>'),t(h).modal(),t.ajax({url:t(y).attr("href"),method:t(y).attr("data-method"),data:{pks:JSON.stringify(o)},success:function(){i(),e()}})),!1)}function u(){t(this).find("i").hasClass("fa-expand")?(l(document.getElementById(g.substring(1))),t(this).find("i").removeClass("fa-expand"),t(this).find("i").addClass("fa-compress"),t(b).addClass("hidden")):(d(),t(this).find("i").removeClass("fa-compress"),t(this).find("i").addClass("fa-expand"),t(b).removeClass("hidden"))}function v(){var e=t(h).find("form");t.ajax({url:t(e).attr("action"),method:t(e).attr("method"),data:t(e).serialize(),success:function(e){200==e.code?(i(),t(h).find(".modal-dialog").addClass("modal-success"),t(h).find(".modal-body").html(e.message),$successNegativeButton=t(C).hasAttr("data-modal-negative-success")?t(this).attr("data-modal-negative-success"):"Close",t(h).find(".modal-footer .btn-default").html($successNegativeButton),t(h).find(".modal-footer .btn-primary").remove()):400==e.code&&t(h).find(".modal-body").html(e.data)}})}function f(){var e=t(h).find("form");t.ajax({url:t(e).attr("action"),method:t(e).attr("method"),data:t(e).serialize(),success:function(e){200==e.code?(i(),t(h).find(".modal-dialog").addClass("modal-success"),t(h).find(".modal-body").html(e.message),$successNegativeButton=t(b).hasAttr("data-modal-negative-success")?t(this).attr("data-modal-negative-success"):"Close",t(h).find(".modal-footer .btn-default").html($successNegativeButton),$successPositiveButton=t(b).hasAttr("data-modal-positive-success")?t(this).attr("data-modal-positive-success"):"Create other",t(h).find(".modal-footer .btn-primary").html($successPositiveButton),t(h).find(".modal-footer .btn-primary").click(function(t){o(),n(t)})):400==e.code&&t(h).find(".modal-body").html(e.data)}})}var h="#ajaxCrubModal",p="#ajaxCrudDatatable",g="#crud-datatable-pjax",b=".create-action-button",B=".delete-action-button",C=".update-action-button",k=".view-action-button",y=".btn-bulk-delete",F=".btn-toggle-fullscreen";t.fn.hasAttr=function(t){return void 0!==this.attr(t)},t(p).on("click",b,n),t(p).on("click",B,s),t(p).on("click",k,r),t(p).on("click",C,c),t(p).on("click",y,m),t(p).on("click",F,u),t(h).on("hidden.bs.modal",o)}(jQuery);